(this["webpackJsonppowietrze.pl"]=this["webpackJsonppowietrze.pl"]||[]).push([[0],{32:function(e,t,n){e.exports=n(47)},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(18),c=n.n(o),i=(n(37),n(38),n(30)),u=n(14),s=n(12),l=n(51),p=n(52),f=n(50),v=n(49),h=n(53),m=(n(39),n(40),6371e3);function d(e){return e/180*Math.PI}function g(e){return 180*e/Math.PI}function w(e,t){var n=d(e.lat),a=d(t.lat),r=d(e.lat-t.lat),o=d(e.lng-t.lng),c=Math.sin(r/2)*Math.sin(r/2)+Math.cos(n)*Math.cos(a)*Math.sin(o/2)*Math.sin(o/2),i=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return m*i}function b(e,t){var n=d(e.lat),a=d(e.lng),r=t/2,o=function(e){var t=m*m*Math.cos(e),n=m*m*Math.sin(e),a=m*Math.cos(e),r=m*Math.sin(e);return Math.sqrt((t*t+n*n)/(a*a+r*r))}(n),c=o*Math.cos(n),i=n+r/o,u=a-r/c,s=a+r/c;return[g(n-r/o),g(u),g(i),g(s)]}var k=n(1),x=n.n(k),j=n(5),y=n.n(j),O=n(10);function M(e){return fetch("https://cors-anywhere.herokuapp.com/looko2.com/tracker.php?lan=&search=".concat(e.Device)).then((function(e){return e.text()})).then((function(e){var t=/PM2\.5.*?(\d+)\sug\/m3\s/g.exec(e);return 2===(null===t||void 0===t?void 0:t.length)&&Number.parseFloat(t[1])||null}))}function _(){var e=Object(a.useState)({lat:51.107,lng:17.0385}),t=Object(s.a)(e,2),n=t[0],o=t[1];navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(e){o({lat:e.coords.latitude,lng:e.coords.longitude})}));var c=function(e,t){var n=Object(a.useState)(null),r=Object(s.a)(n,2),o=r[0],c=r[1];return Object(a.useEffect)((function(){var n=b(e,t),a=Object(s.a)(n,4),r=a[0],o=a[1],i=a[2],u=a[3];fetch("https://cors-anywhere.herokuapp.com/airapi.airly.eu/v2/markers?swLat=".concat(r,"&swLng=").concat(o,"&neLat=").concat(i,"&neLng=").concat(u,"&apikey=fae55480ef384880871f8b40e77bbef9")).then((function(e){return e.json()})).then(function(){var n=Object(O.a)(y.a.mark((function n(a){var r,o,i,u,s;return y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=a.markers,o=r.filter((function(e){return e.hasData})),i=o.map((function(e){return{lat:Number.parseFloat(e.location.latitude),lng:Number.parseFloat(e.location.longitude),id:e.id}})),u=i.filter((function(n){return w(e,n)<t})),n.next=6,Promise.all(u.map(function(){var e=Object(O.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.lat,e.t1=t.lng,e.next=4,fetch("https://cors-anywhere.herokuapp.com/airapi.airly.eu/v2/measurements/installation?apikey=fae55480ef384880871f8b40e77bbef9&installationId=".concat(t.id)).then((function(e){return e.json()})).then(function(){var e=Object(O.a)(y.a.mark((function e(t){var n,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.current.values.filter((function(e){return"PM25"===e.name})),e.abrupt("return",(null===(n=a[0])||void 0===n?void 0:n.value)||null);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:return e.t2=e.sent,e.abrupt("return",{lat:e.t0,lng:e.t1,value:e.t2,source:"AIRLY"});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:s=n.sent,c(s);case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}),[e,t]),{airly_data:o||[]}}(n,1e4).airly_data,i=function(e,t){var n=Object(a.useState)(null),r=Object(s.a)(n,2),o=r[0],c=r[1];return Object(a.useEffect)((function(){fetch("https://cors-anywhere.herokuapp.com/api.gios.gov.pl/pjp-api/rest/station/findAll").then((function(e){return e.json()})).then(function(){var n=Object(O.a)(y.a.mark((function n(a){var r,o,i;return y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=a.map((function(e){return{lat:Number.parseFloat(e.gegrLat),lng:Number.parseFloat(e.gegrLon),id:e.id}})),o=r.filter((function(n){return w(e,n)<t})),n.next=4,Promise.all(o.map(function(){var e=Object(O.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.lat,e.t1=t.lng,e.next=4,fetch("https://cors-anywhere.herokuapp.com/api.gios.gov.pl/pjp-api/rest/station/sensors/".concat(t.id)).then((function(e){return e.json()})).then(function(){var e=Object(O.a)(y.a.mark((function e(t){var n,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.filter((function(e){return"PM2.5"===e.param.paramCode})),a=function(){var e=Object(O.a)(y.a.mark((function e(t){var n,a,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://cors-anywhere.herokuapp.com/api.gios.gov.pl/pjp-api/rest/data/getData/".concat(t.id));case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,r=a.values.filter((function(e){return null!==e.value})),e.abrupt("return",r.length>0?r[0].value:null);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),!(n.length>0)){e.next=8;break}return e.next=5,a(n[0]);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=null;case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:return e.t2=e.sent,e.abrupt("return",{lat:e.t0,lng:e.t1,value:e.t2,source:"GIOS"});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:i=n.sent,c(i);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}),[e,t]),{gios_data:o||[]}}(n,1e4).gios_data,u=function(e,t){var n=Object(a.useState)(null),r=Object(s.a)(n,2),o=r[0],c=r[1];return Object(a.useEffect)((function(){fetch("https://cors-anywhere.herokuapp.com/looko2.com/heatmap.php").then((function(e){return e.text()})).then(function(){var n=Object(O.a)(y.a.mark((function n(a){var r,o,i,u,s,l;return y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=null===(r=/var\sjsonData\s=\s'(.*)';/g.exec(a))||void 0===r?void 0:r[1],i=JSON.parse(o||""),u=i.map((function(e){return{Device:e.Device,lat:Number.parseFloat(e.Lat),lng:Number.parseFloat(e.Lon)}})),s=u.filter((function(n){return w(e,n)<t})),n.next=6,Promise.all(s.map(function(){var e=Object(O.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.lat,e.t1=t.lng,e.next=4,M(t);case 4:return e.t2=e.sent,e.abrupt("return",{lat:e.t0,lng:e.t1,value:e.t2,source:"LOOKO2"});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:l=n.sent,console.log(l),c(l);case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}),[e,t]),{looko2_data:o||[]}}(n,1e4).looko2_data,m=function(e,t){var n=Object(a.useState)(null),r=Object(s.a)(n,2),o=r[0],c=r[1];return Object(a.useEffect)((function(){fetch("https://cors-anywhere.herokuapp.com/czujniki-pwr.kdm.wcss.pl/smog.html").then((function(e){return e.text()})).then((function(n){var a=n.replace(/(.*)\(\s*/g,"$1(").match(/var\smarker_(.*)\s=.*/g),r=(null===a||void 0===a?void 0:a.map((function(e){return Array.from(/marker_(.*)\s=.*\[(.*),\s*(.*)\]/g.exec(e)||[])})))||[],o=n.match(/var\si_frame_(.*)\s=.*/g),i=null===o||void 0===o?void 0:o.map((function(e){var t;return null===(t=/i_frame_(.*)\s=\s.*?base64,(.*?)"/g.exec(e))||void 0===t?void 0:t.slice(1)})),u=new Map(i),s=n.match(/popup_(.*)\.setContent.*/g),l=(null===s||void 0===s?void 0:s.map((function(e){var t;return null===(t=/popup_(.*)\.setContent\(i_frame_(.*)\)/g.exec(e))||void 0===t?void 0:t.slice(1)})))||[],p=new Map(l),f=n.match(/marker_(.*)\.bindPopup.*/g),v=(null===f||void 0===f?void 0:f.map((function(e){var t;return null===(t=/marker_(.*)\.bindPopup\(popup_(.*)\)/g.exec(e))||void 0===t?void 0:t.slice(1)})))||[],h=new Map(v),m=function(e){var t;return Number.parseFloat((null===(t=/>(\d+)\s.*?\xb5g\/m/g.exec(atob(e)))||void 0===t?void 0:t[1])||"")},d=r.map((function(e){return{lat:Number.parseFloat(e[2]),lng:Number.parseFloat(e[3]),value:m(u.get(p.get(h.get(e[1])||"")||"")||"")||null,source:"PWR"}})).filter((function(n){return w(e,n)<t}));c(d)}))}),[e,t]),{pwr_data:o||[]}}(n,1e4).pwr_data,d=(new Array).concat(c).concat(m).concat(i).concat(u),g=x.a.divIcon({className:"div-icon inactive",iconSize:[20,20]}),k=x.a.divIcon({className:"div-icon ok",iconSize:[20,20]}),j=x.a.divIcon({className:"div-icon level-1",iconSize:[20,20]}),_=x.a.divIcon({className:"div-icon level-2",iconSize:[20,20]}),N=x.a.divIcon({className:"div-icon level-3",iconSize:[20,20]}),E=x.a.divIcon({className:"div-icon level-4",iconSize:[20,20]});return r.a.createElement(l.a,{center:n,zoom:10,id:"mapid"},r.a.createElement(p.a,{url:"https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",attribution:'\xa9 <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  \xa9 <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>  <strong><a href="https://www.mapbox.com/map-feedback/" target="_blank" rel="noreferer noopener"> Improve this map</a></strong>',id:"mapbox.light",accessToken:"pk.eyJ1IjoibWthcm9sIiwiYSI6ImNqazl4ODMxMDJ3OTEzd2xlbnN6OHRlMTgifQ.I_mm4Sc8fkKJaFpQc8BWjg"}),r.a.createElement(f.a,{center:n,radius:1e4}),d.map((function(e,t){return r.a.createElement(v.a,{position:e,key:t,icon:(n=e,null===n.value?g:n.value<10?k:n.value<15?j:n.value<25?_:n.value<35?N:E)},e.value&&r.a.createElement(h.a,null,e.value," ug/m3 ",e.source));var n})))}var N=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(i.a,null,r.a.createElement(u.c,null,r.a.createElement(u.a,{exact:!0,path:"/"},r.a.createElement(_,null)))))},E=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function S(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(r.a.createElement(N,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/powietrze",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/powietrze","/service-worker.js");E?(!function(e,t){fetch(e).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):S(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):S(t,e)}))}}()}},[[32,1,2]]]);
//# sourceMappingURL=main.878874a0.chunk.js.map